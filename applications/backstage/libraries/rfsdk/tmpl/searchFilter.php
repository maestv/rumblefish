<?php
/*
 Rumblefish Web Toolkit (PHP)
 
 Copyright 2012 Rumblefish, Inc.
 
 Licensed under the Apache License, Version 2.0 (the "License"); you may
 not use this file except in compliance with the License. You may obtain
 a copy of the License at
 
 http://www.apache.org/licenses/LICENSE-2.0
 
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 License for the specific language governing permissions and limitations
 under the License.
 
 Use of the Rumblefish Sandbox in connection with this file is governed by
 the Sandbox Terms of Use found at https://sandbox.rumblefish.com/agreement
 
 Use of the Rumblefish API for any commercial purpose in connection with
 this file requires a written agreement with Rumblefish, Inc.
 */


$genres[] = array("id" => "22", "name" => "40");
$genres[] = array("id" => "11", "name" => "60");
$genres[] = array("id" => "15", "name" => "70");
$genres[] = array("id" => "19", "name" => "80");
$genres[] = array("id" => "2", "name" => "90");
$genres[] = array("id" => "66", "name" => "acoustic");
$genres[] = array("id" => "80", "name" => "adult");
$genres[] = array("id" => "86", "name" => "age");
$genres[] = array("id" => "23", "name" => "album");
$genres[] = array("id" => "87", "name" => "alternative");
$genres[] = array("id" => "65", "name" => "ambient");
$genres[] = array("id" => "42", "name" => "american");
$genres[] = array("id" => "69", "name" => "americana");
$genres[] = array("id" => "56", "name" => "avant");
$genres[] = array("id" => "30", "name" => "band");
$genres[] = array("id" => "81", "name" => "blues");
$genres[] = array("id" => "12", "name" => "british");
$genres[] = array("id" => "52", "name" => "celtic");
$genres[] = array("id" => "62", "name" => "children");
$genres[] = array("id" => "58", "name" => "christian");
$genres[] = array("id" => "35", "name" => "classic");
$genres[] = array("id" => "82", "name" => "classical");
$genres[] = array("id" => "50", "name" => "coast");
$genres[] = array("id" => "26", "name" => "comedy");
$genres[] = array("id" => "91", "name" => "contemporary");
$genres[] = array("id" => "90", "name" => "country");
$genres[] = array("id" => "38", "name" => "crossover");
$genres[] = array("id" => "41", "name" => "dance");
$genres[] = array("id" => "10", "name" => "dirty");
$genres[] = array("id" => "14", "name" => "east");
$genres[] = array("id" => "79", "name" => "easy");
$genres[] = array("id" => "5", "name" => "electro");
$genres[] = array("id" => "94", "name" => "electronic");
$genres[] = array("id" => "25", "name" => "electronica");
$genres[] = array("id" => "63", "name" => "experimental");
$genres[] = array("id" => "73", "name" => "family");
$genres[] = array("id" => "95", "name" => "folk");
$genres[] = array("id" => "39", "name" => "folky");
$genres[] = array("id" => "44", "name" => "funk");
$genres[] = array("id" => "60", "name" => "fusion");
$genres[] = array("id" => "4", "name" => "garage");
$genres[] = array("id" => "53", "name" => "garde");
$genres[] = array("id" => "48", "name" => "general");
$genres[] = array("id" => "70", "name" => "gospel");
$genres[] = array("id" => "61", "name" => "hard");
$genres[] = array("id" => "36", "name" => "hardcore");
$genres[] = array("id" => "96", "name" => "hip");
$genres[] = array("id" => "45", "name" => "holiday");
$genres[] = array("id" => "97", "name" => "hop");
$genres[] = array("id" => "24", "name" => "industrial");
$genres[] = array("id" => "18", "name" => "inspirational");
$genres[] = array("id" => "75", "name" => "instrumental");
$genres[] = array("id" => "93", "name" => "jazz");
$genres[] = array("id" => "72", "name" => "kids");
$genres[] = array("id" => "64", "name" => "latin");
$genres[] = array("id" => "78", "name" => "listening");
$genres[] = array("id" => "76", "name" => "metal");
$genres[] = array("id" => "1", "name" => "mix");
$genres[] = array("id" => "84", "name" => "modern");
$genres[] = array("id" => "17", "name" => "mood");
$genres[] = array("id" => "74", "name" => "music");
$genres[] = array("id" => "89", "name" => "new");
$genres[] = array("id" => "49", "name" => "orchestral");
$genres[] = array("id" => "43", "name" => "piano");
$genres[] = array("id" => "99", "name" => "pop");
$genres[] = array("id" => "3", "name" => "post");
$genres[] = array("id" => "33", "name" => "power");
$genres[] = array("id" => "8", "name" => "praise");
$genres[] = array("id" => "67", "name" => "progressive");
$genres[] = array("id" => "28", "name" => "psychedelic");
$genres[] = array("id" => "83", "name" => "punk");
$genres[] = array("id" => "16", "name" => "quirky");
$genres[] = array("id" => "77", "name" => "r&b");
$genres[] = array("id" => "98", "name" => "rap");
$genres[] = array("id" => "57", "name" => "reggae");
$genres[] = array("id" => "100", "name" => "rock");
$genres[] = array("id" => "32", "name" => "roll");
$genres[] = array("id" => "51", "name" => "roots");
$genres[] = array("id" => "68", "name" => "s");
$genres[] = array("id" => "59", "name" => "smooth");
$genres[] = array("id" => "6", "name" => "soft");
$genres[] = array("id" => "29", "name" => "solo");
$genres[] = array("id" => "9", "name" => "songs");
$genres[] = array("id" => "55", "name" => "soul");
$genres[] = array("id" => "13", "name" => "south");
$genres[] = array("id" => "31", "name" => "southern");
$genres[] = array("id" => "92", "name" => "spiritual");
$genres[] = array("id" => "47", "name" => "spoken");
$genres[] = array("id" => "27", "name" => "style");
$genres[] = array("id" => "21", "name" => "today");
$genres[] = array("id" => "20", "name" => "top");
$genres[] = array("id" => "71", "name" => "traditional");
$genres[] = array("id" => "54", "name" => "underground");
$genres[] = array("id" => "85", "name" => "urban");
$genres[] = array("id" => "34", "name" => "west");
$genres[] = array("id" => "40", "name" => "with");
$genres[] = array("id" => "46", "name" => "word");
$genres[] = array("id" => "88", "name" => "world");
$genres[] = array("id" => "7", "name" => "worship");

$catalogs[] = array("id" => "5", "provider_name" => "APM");
$catalogs[] = array("id" => "4", "provider_name" => "CD Baby");
$catalogs[] = array("id" => "1", "provider_name" => "Indaba");
$catalogs[] = array("id" => "3", "provider_name" => "Rumblefish");

//$licences[] = array("short_description" => "Create a Mash to instantly share any YouTube video with this song as the soundtrack (comes without download)", "licencelabel" => "Mash", "price" => "0", "id" => "13");
//$licences[] = array("short_description" => "Create a Mash to instantly share any YouTube video with this song as the soundtrack (comes without download)", "licencelabel" => "Mash", "price" => "0.99", "id" => "14");
$licences[] = array("short_description" => "Download this song and use it as a soundtrack in a personal online video", "licencelabel" => "Personal", "price" => "1.99", "id" => "1");
$licences[] = array("short_description" => "Download this song and use it as a soundtrack in an online video for your small business (<$1M in revenue & <10 employees)", "licencelabel" => "Commercial", "price" => "25", "id" => "20");
$licences[] = array("short_description" => "Download this song and use it as a soundtrack in an online video for your medium business<$3M in revenue & <20 employees)", "licencelabel" => "Commercial Premium", "price" => "125", "id" => "8");

?>
<div class="row">
    <h2 class="column">Use filters and keywords to narrow down your results.</h2>
</div>
<div id="searchbox">
    <div  class="searchfilters">
        <div class="row">
            <div class="column">
                <label>Genre</label><br />
                <select name="genre" class="searchselect" id="searchgenre"><option value="">Any</option>
                    <?php foreach ($genres as $key => $genre) {
                        ?>
                        <option value="<?php echo $genre['name'] ?>" ><?php echo ucwords(strtolower($genre['name'])); ?></option>
                    <?php }?>
                </select>
            </div>
            <div class="column">
                <label>Duration</label><br />
                <select name="duration" class="searchselect" id="searchduration"><option value="">Any</option>
                    <option value="0-30" >0 - 30 seconds</option>
                    <option value="30-60" >30 - 60 seconds</option>
                    <option value="60-90" >60 - 90 seconds</option>
                    <option value="90-120" >90 - 120 seconds</option>
                    <option value="120-150" >120 - 150 seconds</option>
                    <option value="150-180" >150 - 180 seconds</option>
                    <option value="180-3000" >180 seconds plus</option>
                </select>
            </div>
            <div class="column">
                <label>BPM</label><br />
                <select name="bpm" id="searchbpm" class="searchselect"><option value="">Any</option>
                    <option value="0-50" >0 - 50 BPM</option>
                    <option value="50-100" >50 - 100 BPM</option>
                    <option value="100-150" >100 - 150 BPM</option>
                    <option value="150-200" >150 - 200 BPM</option>
                    <option value="200-250" >200 - 250 BPM</option>
                    <option value="250-3000">250 BPM Plus</option>
                </select>
            </div>

            <div class="column">
                <label>Explicit Lyrics</label><br />
                <select name="explicit" id="searchexplicit" class="searchselect"><option value="">Any</option>
                    <option value="1" >Yes</option>
                    <option value="0" >No</option></select>
            </div>

             <div class="two column">
                <label>License Type/Price</label><br />
                <select name="licence" id="searchlicence" class="searchselect">
                    <option value="">All</option>
                    <?php foreach($licences as $licence){ ?>
                    <option title="<?php echo $license['short_description'];?>" value="<?php echo $licence['id'];?>" ><?php echo $licence['licencelabel'];?> / <?php echo $licence['price']; ?></option>
                    <?php } ?>
                </select>
            </div>
        </div>
        <div class="row">
            <label>Catalogs</label><br />
            <?php foreach ($catalogs as $catalog) { ?>
            <form id="myform">
                <div class="column">
                    <label class="left tooltip"><?php echo $catalog['provider_name']; ?></label>
                    <div class="checkbox">
                        <input class="catalog_search_checkbox provider" checked="checked" type="checkbox" name="provider_id[]" value="<?php echo $catalog['id']; ?>" >
                    </div>
                </div>
            </form>
            <?php } ?>
        </div>
        <div class="row">
            <label>Music Curation</label><br />
                <div class="column">
                    <label class="left" tooltip="Soundtracks hand-picked by our music editorial staff">Curated</label>
                    <div class="checkbox"><input class="catalog_search_checkbox rank" type="radio" name="rank" value="1"></div>
                </div>
                <div class="column">
                    <label class="left" tooltip="Our entire, amazing catalog in its full glory">Everything</label>
                    <div class="checkbox"><input class="catalog_search_checkbox rank" type="radio" checked="checked" name="rank" value="0" ></div>
                </div>
        </div>
        <div class="row">
        </div>
    </div>
</div>
<span class="searchtab"><input type="text" id="tabsearch" name="search" placeholder="Occasion, artist, song name or keyword"><input type="button" value="Go!" class="button tabsearchbutton"></span>
<div id="searchResults"><img src="../img/loader.gif" /></div>

<script>
    var filter = [];
    $(".checkbox").dgStyle();
    $(function() {
        $('select.searchselect').dropkick({
            theme: 'black',
            change: function (value, label) {
                var name = $(this).attr('name');
                filter[name] = value;
                postNow();
            }
        });
        
        $('.provider').change(function() {
            var pro='';
            var x=1;
            $('.provider:checked').each(function(index){
                pro += $(this).val();
                if (x < $('.provider:checked').size()){
                     pro +=',';
                }
                x++;
            });
            filter['provider_id'] = pro;

            postNow();
        });
        $("input:radio[name=rank]").change(function() {
            filter['rank'] = $(this).val();
            postNow();
        });
        $("#tabsearch").keypress(function (event) {
            if (event.which === 13) {
                $('.tabsearchbutton').trigger('click');
            }
        });
        $(".tabsearchbutton").click(function (event) {
            filter['q'] = $('#tabsearch').val();
            postNow();
        });

        $('#searchResults').load('/demo-ajax/search_table.php');
    });
    
    function postNow(){

        var poster = '{';
        var x = 1;
        for(var index in filter) {
            poster += '"'+index + '":"' + filter[index] + '"';

            if (x < Object.keys(filter).length){
                poster += ',';
            }
            x++;
        }
        poster += '}';
        $('#searchResults').html('<img src="../img/loader.gif" />');
        $('#searchResults').load('/demo-ajax/search_table.php',JSON.parse(poster));

    }
</script>
